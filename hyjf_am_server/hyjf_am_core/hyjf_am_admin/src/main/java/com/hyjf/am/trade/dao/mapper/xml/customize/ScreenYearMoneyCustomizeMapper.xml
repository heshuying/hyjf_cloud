<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hyjf.am.trade.dao.mapper.customize.ScreenYearMoneyCustomizeMapper">

	<insert id="addRepayUserList">
		insert into ht_repayment_plan
		(`user_id`, `borrow_nid`, `accede_order_id`, `customer_name`, `customer_group`, `money`, `repayment_time`)
		values
		<foreach collection="repaymentPlanVOS" item="item" index="index" separator=",">
			(#{item.userId},#{item.borrowNid},#{item.accedeOrderId},#{item.customerName},#{item.customerGroup},#{item.money},#{item.repaymentTime})
		</foreach>
	</insert>

	<select id="getRechargeList" resultType="com.hyjf.am.resquest.trade.ScreenDataBean">
		SELECT t1.user_id AS userId,t2.username AS userName,t1.money AS money ,'2' AS operating
		from ht_account_recharge t1
				 left join ht_r_user t2 on t1.user_id = t2.user_id
		where t1.create_time <![CDATA[>=]]> STR_TO_DATE('2019-03-01 00:00:00', '%Y-%m-%d %H:%i:%s')
		      AND t1.create_time <![CDATA[<]]> STR_TO_DATE('2019-03-04 00:00:00', '%Y-%m-%d %H:%i:%s')
			  limit #{startIndex},#{endIndex}
	</select>

	<select id="getWithdrawList" resultType="com.hyjf.am.resquest.trade.ScreenDataBean">
		SELECT t1.user_id AS userId,t2.username AS userName,t1.total AS money,'4' AS operating
		from ht_account_withdraw t1
		left join ht_r_user t2 on t1.user_id = t2.user_id
		where t1.create_time <![CDATA[>=]]> STR_TO_DATE('2019-03-01 00:00:00', '%Y-%m-%d %H:%i:%s')
		      AND t1.create_time <![CDATA[<]]> STR_TO_DATE('2019-03-04 00:00:00', '%Y-%m-%d %H:%i:%s')
			  limit #{startIndex},#{endIndex}
	</select>

	<select id="getBorrowRecoverList" resultType="com.hyjf.am.resquest.trade.ScreenDataBean">
		SELECT t1.nid orderId,t1.user_id userId, t1.user_name userName,t1.recover_account_yes money,'3' AS operating
		from ht_borrow_recover t1
		where t1.recover_yestime <![CDATA[>=]]> UNIX_TIMESTAMP('2019-03-01 00:00:00')
			  and t1.recover_yestime <![CDATA[<]]> UNIX_TIMESTAMP('2019-03-04 00:00:00')
			  limit #{startIndex},#{endIndex}
	</select>

	<select id="getBorrowTenderList" resultType="com.hyjf.am.resquest.trade.ScreenDataBean">
		SELECT bt.user_name as userName,bt.user_id as userId, bt.nid as orderId,bt.account as money,
			   b.project_type AS projectType,'1' as operating
		FROM ht_borrow_tender bt
		INNER JOIN ht_borrow b ON bt.borrow_nid = b.borrow_nid
		where bt.create_time <![CDATA[>=]]> STR_TO_DATE('2019-03-01 00:00:00', '%Y-%m-%d %H:%i:%s')
		      AND bt.create_time <![CDATA[<]]> STR_TO_DATE('2019-03-04 00:00:00', '%Y-%m-%d %H:%i:%s')
			  limit #{startIndex},#{endIndex}
	</select>


</mapper>