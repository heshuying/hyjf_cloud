<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.hyjf.am.trade.dao.mapper.customize.ScreenYearMoneyCustomizeMapper">

	<insert id="addRepayUserList">
		insert into ht_repayment_plan
		(`user_id`, `borrow_nid`, `accede_order_id`, `customer_name`, `customer_group`, `money`, `repayment_time`)
		values
		<foreach collection="repaymentPlanVOS" item="item" index="index" separator=",">
			(#{item.userId},#{item.borrowNid},#{item.accedeOrderId},#{item.customerName},#{item.customerGroup},#{item.money},#{item.repaymentTime})
		</foreach>
	</insert>

	<select id="getRechargeList" resultType="com.hyjf.am.resquest.trade.ScreenDataBean">
		SELECT t1.user_id AS userId,t2.username AS userName,t1.money AS money ,'2' AS operating
		from ht_account_recharge t1
				 left join ht_r_user t2 on t1.user_id = t2.user_id
		where t1.create_time <![CDATA[>=]]> '2018-03-01 00:00:00'
		  AND t1.create_time <![CDATA[<]]> '2019-03-04 00:00:00'
			limit #{startIndex},#{endIndex}
	</select>

	<select id="getPlanRepayList" resultType="com.hyjf.am.resquest.trade.ScreenDataBean" parameterType="java.util.HashMap">
		SELECT  t1.user_id AS userId,t1.user_name AS userName,SUM(t1.actual_pay_total) AS money ,'3' AS operating from ht_hjh_repay t1
		where t1.repay_status = 2 and t1.order_status=7 and  t1.repay_actual_time <![CDATA[>=]]>  UNIX_TIMESTAMP('2018-04-01 00:00:00')
		AND t1.repay_actual_time <![CDATA[<]]>  UNIX_TIMESTAMP('2018-04-03 18:00:00') GROUP BY userId,user_name,operating
		limit #{startIndex},#{endIndex}
	</select>

	<select id="getCreditTenderList" resultType="com.hyjf.am.resquest.trade.ScreenDataBean" parameterType="java.util.HashMap">
		select  t1.user_id AS userId,t1.user_name AS userName,SUM(t1.assign_capital) AS money ,'3' AS operating from ht_credit_tender t1
		where t1.create_time <![CDATA[>=]]>  STR_TO_DATE('2018-04-01 00:00:00','%Y-%m-%d %H:%i:%s')
		AND t1.create_time <![CDATA[<]]>  STR_TO_DATE('2018-04-03 18:00:00','%Y-%m-%d %H:%i:%s') GROUP BY userId,user_name,operating
		limit #{startIndex},#{endIndex}
	</select>
	<select id="getPlanTenderList" resultType="com.hyjf.am.resquest.trade.ScreenDataBean" parameterType="java.util.HashMap">
		select  t1.user_id AS userId,t1.user_name AS userName,SUM(t1.accede_account) AS money ,'1' AS operating from ht_hjh_accede t1
		where t1.create_time <![CDATA[>=]]>  STR_TO_DATE('2018-04-01 00:00:00','%Y-%m-%d %H:%i:%s')
		AND t1.create_time <![CDATA[<]]>  STR_TO_DATE('2018-04-03 18:00:00','%Y-%m-%d %H:%i:%s') GROUP BY userId,user_name,operating
		limit #{startIndex},#{endIndex}
	</select>
	<select id="getWithdrawList" resultType="com.hyjf.am.resquest.trade.ScreenDataBean">
		SELECT t1.user_id AS userId,t2.username AS userName,t1.total AS money,'4' AS operating
		from ht_account_withdraw t1
				 left join ht_r_user t2 on t1.user_id = t2.user_id
		where t1.create_time <![CDATA[>=]]> '2018-03-01 00:00:00'
		  AND t1.create_time <![CDATA[<]]> '2019-03-04 00:00:00'
			limit #{startIndex},#{endIndex}
	</select>


</mapper>